{"ast":null,"code":"import _asyncToGenerator from \"/home/saumya/Documents/Project.Tech/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport { projectStorage } from '../firebase/config';\nimport { ref } from \"vue\";\nimport getUser from \"./getUser\";\n\nvar _getUser = getUser(),\n    user = _getUser.user;\n\nvar useStorage = function useStorage() {\n  var error = ref(null);\n  var url = ref(null);\n  var filePath = ref(null);\n\n  var uploadImage = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(file) {\n      var storageRef, res;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              filePath.value = \"covers/\".concat(user.value.uid, \"/\").concat(file.name);\n              storageRef = projectStorage.ref(filePath.value);\n              _context.prev = 2;\n              _context.next = 5;\n              return storageRef.put(file);\n\n            case 5:\n              res = _context.sent;\n              _context.next = 8;\n              return res.ref.getDownloadURL();\n\n            case 8:\n              url.value = _context.sent;\n              _context.next = 15;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](2);\n              console.log(_context.t0.message);\n              error.value = _context.t0;\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 11]]);\n    }));\n\n    return function uploadImage(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var deleteImage = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(path) {\n      var storageRef;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              storageRef = projectStorage.ref(path);\n              _context2.prev = 1;\n              _context2.next = 4;\n              return storageRef[\"delete\"]();\n\n            case 4:\n              _context2.next = 10;\n              break;\n\n            case 6:\n              _context2.prev = 6;\n              _context2.t0 = _context2[\"catch\"](1);\n              console.log(_context2.t0.message);\n              error.value = _context2.t0;\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 6]]);\n    }));\n\n    return function deleteImage(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return {\n    uploadImage: uploadImage,\n    deleteImage: deleteImage,\n    url: url,\n    filePath: filePath,\n    error: error\n  };\n};\n\nexport default useStorage;","map":{"version":3,"sources":["/home/saumya/Documents/Project.Tech/src/composables/useStorage.js"],"names":["projectStorage","ref","getUser","user","useStorage","error","url","filePath","uploadImage","file","value","uid","name","storageRef","put","res","getDownloadURL","console","log","message","deleteImage","path"],"mappings":";;;;AAAA,SAASA,cAAT,QAA+B,oBAA/B;AACA,SAASC,GAAT,QAAoB,KAApB;AACA,OAAOC,OAAP,MAAoB,WAApB;;AAEA,eAAiBA,OAAO,EAAxB;AAAA,IAAQC,IAAR,YAAQA,IAAR;;AAEA,IAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvB,MAAMC,KAAK,GAAGJ,GAAG,CAAC,IAAD,CAAjB;AACA,MAAMK,GAAG,GAAGL,GAAG,CAAC,IAAD,CAAf;AACA,MAAMM,QAAQ,GAAGN,GAAG,CAAC,IAAD,CAApB;;AAEA,MAAMO,WAAW;AAAA,uEAAG,iBAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAClBF,cAAAA,QAAQ,CAACG,KAAT,oBAA2BP,IAAI,CAACO,KAAL,CAAWC,GAAtC,cAA6CF,IAAI,CAACG,IAAlD;AACMC,cAAAA,UAFY,GAECb,cAAc,CAACC,GAAf,CAAmBM,QAAQ,CAACG,KAA5B,CAFD;AAAA;AAAA;AAAA,qBAKEG,UAAU,CAACC,GAAX,CAAeL,IAAf,CALF;;AAAA;AAKVM,cAAAA,GALU;AAAA;AAAA,qBAMEA,GAAG,CAACd,GAAJ,CAAQe,cAAR,EANF;;AAAA;AAMhBV,cAAAA,GAAG,CAACI,KANY;AAAA;AAAA;;AAAA;AAAA;AAAA;AAQhBO,cAAAA,OAAO,CAACC,GAAR,CAAY,YAAIC,OAAhB;AACAd,cAAAA,KAAK,CAACK,KAAN;;AATgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAXF,WAAW;AAAA;AAAA;AAAA,KAAjB;;AAaA,MAAMY,WAAW;AAAA,wEAAG,kBAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACZR,cAAAA,UADY,GACCb,cAAc,CAACC,GAAf,CAAmBoB,IAAnB,CADD;AAAA;AAAA;AAAA,qBAIVR,UAAU,UAAV,EAJU;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAMhBI,cAAAA,OAAO,CAACC,GAAR,CAAY,aAAIC,OAAhB;AACAd,cAAAA,KAAK,CAACK,KAAN;;AAPgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAXU,WAAW;AAAA;AAAA;AAAA,KAAjB;;AAWA,SAAO;AAAEZ,IAAAA,WAAW,EAAXA,WAAF;AAAeY,IAAAA,WAAW,EAAXA,WAAf;AAA4Bd,IAAAA,GAAG,EAAHA,GAA5B;AAAiCC,IAAAA,QAAQ,EAARA,QAAjC;AAA2CF,IAAAA,KAAK,EAALA;AAA3C,GAAP;AACD,CA9BD;;AAgCA,eAAeD,UAAf","sourcesContent":["import { projectStorage } from '../firebase/config'\nimport { ref } from \"vue\"\nimport getUser from \"./getUser\"\n\nconst { user } = getUser()\n\nconst useStorage = () => {\n  const error = ref(null)\n  const url = ref(null)\n  const filePath = ref(null)\n\n  const uploadImage = async (file) => {\n    filePath.value = `covers/${user.value.uid}/${file.name}`\n    const storageRef = projectStorage.ref(filePath.value)\n\n    try {\n      const res = await storageRef.put(file)\n      url.value = await res.ref.getDownloadURL()\n    } catch (err) {\n      console.log(err.message)\n      error.value = err\n    }\n  }\n\n  const deleteImage = async (path) => {\n    const storageRef = projectStorage.ref(path);\n\n    try {\n      await storageRef.delete()\n    } catch (err) {\n      console.log(err.message)\n      error.value = err\n    }\n  }\n\n  return { uploadImage, deleteImage, url, filePath, error }\n}\n\nexport default useStorage;"]},"metadata":{},"sourceType":"module"}