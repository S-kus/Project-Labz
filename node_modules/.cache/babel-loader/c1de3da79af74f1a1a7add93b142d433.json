{"ast":null,"code":"import { ref } from 'vue';\nimport useStorage from '@/composables/useStorage';\nimport useCollection from '@/composables/useCollection';\nimport getUser from '@/composables/getUser';\nimport { timestamp } from '@/firebase/config'; // import { useRouter } from 'vue-router'\n\nexport default {\n  setup() {\n    const {\n      filePath,\n      url,\n      uploadImage\n    } = useStorage();\n    const {\n      error,\n      addDoc\n    } = useCollection('projectlists');\n    const {\n      user\n    } = getUser(); // const router = useRouter()\n\n    const title = ref('');\n    const description = ref('');\n    const file = ref(null);\n    const fileError = ref(null);\n    const isPending = ref(false);\n\n    const handleSubmit = async () => {\n      if (file.value) {\n        isPending.value = true;\n        await uploadImage(file.value);\n        const res = await addDoc({\n          title: title.value,\n          description: description.value,\n          userId: user.value.uid,\n          userName: user.value.displayName,\n          coverUrl: url.value,\n          filePath: filePath.value,\n          // so we can delete it later\n          projects: [],\n          createdAt: timestamp()\n        });\n        isPending.value = false;\n\n        if (!error.value) {\n          //router.push({ name: 'ProjectlistDetails', params: { id: res.id }})\n          console.log('done!');\n        }\n      }\n    }; // allowed file types\n\n\n    const types = ['image/png', 'image/jpeg'];\n\n    const handleChange = e => {\n      let selected = e.target.files[0];\n      console.log(selected);\n\n      if (selected && types.includes(selected.type)) {\n        file.value = selected;\n        fileError.value = null;\n      } else {\n        file.value = null;\n        fileError.value = 'Please select an image file (png or jpeg)';\n      }\n    };\n\n    return {\n      title,\n      description,\n      handleSubmit,\n      fileError,\n      handleChange,\n      isPending\n    };\n  }\n\n};","map":{"version":3,"mappings":"AAkBA,SAASA,GAAT,QAAoB,KAApB;AACA,OAAOC,UAAP,MAAuB,0BAAvB;AACA,OAAOC,aAAP,MAA0B,6BAA1B;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,SAASC,SAAT,QAA0B,mBAA1B,C,CACA;;AAEA,eAAe;AACbC,OAAK,GAAG;AACN,UAAM;AAAEC,cAAF;AAAYC,SAAZ;AAAiBC;AAAjB,QAAiCP,UAAU,EAAjD;AACA,UAAM;AAAEQ,WAAF;AAASC;AAAT,QAAoBR,aAAa,CAAC,cAAD,CAAvC;AACA,UAAM;AAAES;AAAF,QAAWR,OAAO,EAAxB,CAHM,CAIN;;AAEA,UAAMS,KAAI,GAAIZ,GAAG,CAAC,EAAD,CAAjB;AACA,UAAMa,WAAU,GAAIb,GAAG,CAAC,EAAD,CAAvB;AACA,UAAMc,IAAG,GAAId,GAAG,CAAC,IAAD,CAAhB;AACA,UAAMe,SAAQ,GAAIf,GAAG,CAAC,IAAD,CAArB;AACA,UAAMgB,SAAQ,GAAIhB,GAAG,CAAC,KAAD,CAArB;;AAEA,UAAMiB,YAAW,GAAI,YAAY;AAC/B,UAAIH,IAAI,CAACI,KAAT,EAAgB;AACdF,iBAAS,CAACE,KAAV,GAAkB,IAAlB;AACA,cAAMV,WAAW,CAACM,IAAI,CAACI,KAAN,CAAjB;AACA,cAAMC,GAAE,GAAI,MAAMT,MAAM,CAAC;AACvBE,eAAK,EAAEA,KAAK,CAACM,KADU;AAEvBL,qBAAW,EAAEA,WAAW,CAACK,KAFF;AAGvBE,gBAAM,EAAET,IAAI,CAACO,KAAL,CAAWG,GAHI;AAIvBC,kBAAQ,EAAEX,IAAI,CAACO,KAAL,CAAWK,WAJE;AAKvBC,kBAAQ,EAAEjB,GAAG,CAACW,KALS;AAMvBZ,kBAAQ,EAAEA,QAAQ,CAACY,KANI;AAMG;AAC1BO,kBAAQ,EAAE,EAPa;AAQvBC,mBAAS,EAAEtB,SAAS;AARG,SAAD,CAAxB;AAUAY,iBAAS,CAACE,KAAV,GAAkB,KAAlB;;AACA,YAAI,CAACT,KAAK,CAACS,KAAX,EAAkB;AAChB;AACAS,iBAAO,CAACC,GAAR,CAAY,OAAZ;AACF;AACF;AACF,KApBA,CAZM,CAkCN;;;AACA,UAAMC,KAAI,GAAI,CAAC,WAAD,EAAc,YAAd,CAAd;;AAEA,UAAMC,YAAW,GAAKC,CAAD,IAAO;AAC1B,UAAIC,QAAO,GAAID,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CAAf;AACAP,aAAO,CAACC,GAAR,CAAYI,QAAZ;;AAEA,UAAIA,QAAO,IAAKH,KAAK,CAACM,QAAN,CAAeH,QAAQ,CAACI,IAAxB,CAAhB,EAA+C;AAC7CtB,YAAI,CAACI,KAAL,GAAac,QAAb;AACAjB,iBAAS,CAACG,KAAV,GAAkB,IAAlB;AACF,OAHA,MAGO;AACLJ,YAAI,CAACI,KAAL,GAAa,IAAb;AACAH,iBAAS,CAACG,KAAV,GAAkB,2CAAlB;AACF;AACF,KAXA;;AAaA,WAAO;AAAEN,WAAF;AAASC,iBAAT;AAAsBI,kBAAtB;AAAoCF,eAApC;AAA+Ce,kBAA/C;AAA6Dd;AAA7D,KAAP;AACF;;AApDa,CAAf","names":["ref","useStorage","useCollection","getUser","timestamp","setup","filePath","url","uploadImage","error","addDoc","user","title","description","file","fileError","isPending","handleSubmit","value","res","userId","uid","userName","displayName","coverUrl","projects","createdAt","console","log","types","handleChange","e","selected","target","files","includes","type"],"sourceRoot":"","sources":["/home/saumya/Documents/Project.Tech/project-tech/src/views/projectlists/CreateProjectlist.vue"],"sourcesContent":["<template>\n  <div>\n    <form @submit.prevent=\"handleSubmit\">\n      <h4>Create a New Projectlist</h4>\n      <input type=\"text\" required placeholder=\"Projectlist title\" v-model=\"title\">\n      <textarea required placeholder=\"Projectlist description...\" v-model=\"description\"></textarea>\n      <!-- upload projectlist image -->\n      <label>Upload Projectlist Cover Image</label>\n      <input type=\"file\" @change=\"handleChange\">\n      <div class=\"error\">{{ fileError }}</div>\n\n      <button v-if=\"!isPending\">Create</button>\n      <button v-else disabled>Saving...</button>\n    </form>\n  </div>\n</template>\n\n<script>\nimport { ref } from 'vue'\nimport useStorage from '@/composables/useStorage'\nimport useCollection from '@/composables/useCollection'\nimport getUser from '@/composables/getUser'\nimport { timestamp } from '@/firebase/config'\n// import { useRouter } from 'vue-router'\n\nexport default {\n  setup() {\n    const { filePath, url, uploadImage } = useStorage()\n    const { error, addDoc } = useCollection('projectlists')\n    const { user } = getUser()\n    // const router = useRouter()\n\n    const title = ref('')\n    const description = ref('')\n    const file = ref(null)\n    const fileError = ref(null)\n    const isPending = ref(false)\n\n    const handleSubmit = async () => {\n      if (file.value) {\n        isPending.value = true\n        await uploadImage(file.value)\n        const res = await addDoc({\n          title: title.value,\n          description: description.value,\n          userId: user.value.uid,\n          userName: user.value.displayName,\n          coverUrl: url.value,\n          filePath: filePath.value, // so we can delete it later\n          projects: [],\n          createdAt: timestamp()\n        })\n        isPending.value = false\n        if (!error.value) {\n          //router.push({ name: 'ProjectlistDetails', params: { id: res.id }})\n          console.log('done!')\n        }\n      }\n    }\n\n    // allowed file types\n    const types = ['image/png', 'image/jpeg']\n\n    const handleChange = (e) => {\n      let selected = e.target.files[0]\n      console.log(selected)\n\n      if (selected && types.includes(selected.type)) {\n        file.value = selected\n        fileError.value = null\n      } else {\n        file.value = null\n        fileError.value = 'Please select an image file (png or jpeg)'\n      }\n    }\n    \n    return { title, description, handleSubmit, fileError, handleChange, isPending }\n  }\n}\n</script>\n\n<style>\n  form {\n    background: white;\n  }\n  input[type=\"file\"] {\n    border: 0;\n    padding: 0;\n  }\n  label {\n    font-size: 12px;\n    display: block;\n    margin-top: 30px;\n  }\n  button {\n    margin-top: 20px;\n  }\n</style>"]},"metadata":{},"sourceType":"module"}